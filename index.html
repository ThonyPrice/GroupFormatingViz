<html>
  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(function() { drawChart('Q', 'E'); });
    </script>
    <script type="text/javascript">

      current_x = '';
      current_y = '';
      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.

      function drawChart(x_value, y_value) {
          current_x = x_value;
          current_y = y_value;
          var opts = '&gid=0&numers=1';
          var url = 'https://docs.google.com/spreadsheets/d/1y6t7rlTMO3W020Boibd52KUHdddwExhSqYI8aiIDcvw/edit?usp=sharing';
          var query = new google.visualization.Query(url+opts);
          var select_query = "SELECT A,"+x_value+","+y_value+",B"
          query.setQuery(select_query);
          query.send(function (response) {
              if (response.isError()) {
                  alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                  return;
              }

              var data = response.getDataTable();

              var chart = new google.visualization.BubbleChart(document.querySelector('#chart_div'));

              var options = {
                title: 'Correlation between life expectancy, fertility rate ' +
                       'and population of some world countries (2010)',
                hAxis: {title: data.getColumnLabel(1)},
                vAxis: {title: data.getColumnLabel(2)},
                bubble: {textStyle: {fontSize: 11}}
              };

              chart.draw(data, options);
          });
      }
      // google.charts.load('visualization', '1', {packages:['corechart'], callback: drawChart});

      function changeX(x) {
        drawChart(x, current_y);
      }

      function changeY(y) {
        drawChart(current_x, y);
      }

    </script>
  </head>

  <body>
    <!--Div that will hold the pie chart-->
    <div id="chart_div" style="width: 1000px; height: 800px;"></div>
    <!--Change x-axis-->
    <h4>Change x-axis skill</h4>
    <select name="numbers" onchange="changeX(this.value)">
      <option value="current_x">Please select x-axis skills</option>
      <option value='E'>Visualization</option>
      <option value='F'>Statistics</option>
      <option value='G'>Mathematical</option>
      <option value='H'>Drawing and artistic</option>
      <option value='I'>Computer usage</option>
      <option value='J'>Programming</option>
      <option value='K'>Graphics programming</option>
      <option value='L'>Human-computer interaction programming</option>
      <option value='M'>User experience evaluation</option>
      <option value='N'>Communication</option>
      <option value='O'>Collaboration</option>
      <option value='P'>Code repository</option>
      <option value='Q'>Sum of all skills</option>
    </select>
    <!--Change x-axis-->
    <h4>Change y-axis skill</h4>
    <select name="numbers" onchange="changeY(this.value)">
      <option value="">Please select y-axis skills</option>
      <option value='E'>Visualization</option>
      <option value='F'>Statistics</option>
      <option value='G'>Mathematical</option>
      <option value='H'>Drawing and artistic</option>
      <option value='I'>Computer usage</option>
      <option value='J'>Programming</option>
      <option value='K'>Graphics programming</option>
      <option value='L'>Human-computer interaction programming</option>
      <option value='M'>User experience evaluation</option>
      <option value='N'>Communication</option>
      <option value='O'>Collaboration</option>
      <option value='P'>Code repository</option>
      <option value='Q'>Sum of all skills</option>
  </select>

  </body>
</html>
